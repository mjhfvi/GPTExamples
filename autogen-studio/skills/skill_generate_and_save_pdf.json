{
  "content": "import uuid\nimport requests\nfrom fpdf import FPDF\nfrom typing import List, Dict, Optional\nfrom pathlib import Path\nfrom PIL import Image, ImageDraw, ImageOps\nfrom io import BytesIO\n\ndef generate_and_save_pdf(\n    sections: List[Dict[str, Optional[str]]], \n    output_file: str = \"report.pdf\", \n    report_title: str = \"PDF Report\"\n) -> None:\n    \"\"\"\n    Function to generate a beautiful PDF report in A4 paper format. \n\n    :param sections: A list of sections where each section is represented by a dictionary containing:\n                     - title: The title of the section.\n                     - level: The heading level (e.g., \"title\", \"h1\", \"h2\").\n                     - content: The content or body text of the section.\n                     - image: (Optional) The URL or local path to the image.\n    :param output_file: The name of the output PDF file. (default is \"report.pdf\")\n    :param report_title: The title of the report. (default is \"PDF Report\")\n    :return: None\n    \"\"\"\n\n    def get_image(image_url_or_path):\n        if image_url_or_path.startswith(\"http://\") or image_url_or_path.startswith(\"https://\"):\n            response = requests.get(image_url_or_path)\n            if response.status_code == 200:\n                return BytesIO(response.content)\n        elif Path(image_url_or_path).is_file():\n            return open(image_url_or_path, 'rb')\n        return None\n\n    def add_rounded_corners(img, radius=6):\n        mask = Image.new('L', img.size, 0)\n        draw = ImageDraw.Draw(mask)\n        draw.rounded_rectangle([(0, 0), img.size], radius, fill=255)\n        img = ImageOps.fit(img, mask.size, centering=(0.5, 0.5))\n        img.putalpha(mask)\n        return img\n\n    class PDF(FPDF):\n        def header(self):\n            self.set_font(\"Arial\", \"B\", 12)\n            self.cell(0, 10, report_title, 0, 1, \"C\")\n            \n        def chapter_title(self, txt): \n            self.set_font(\"Arial\", \"B\", 12)\n            self.cell(0, 10, txt, 0, 1, \"L\")\n            self.ln(2)\n        \n        def chapter_body(self, body):\n            self.set_font(\"Arial\", \"\", 12)\n            self.multi_cell(0, 10, body)\n            self.ln()\n\n        def add_image(self, img_data):\n            img = Image.open(img_data)\n            img = add_rounded_corners(img)\n            img_path = Path(f\"temp_{uuid.uuid4().hex}.png\")\n            img.save(img_path, format=\"PNG\")\n            self.image(str(img_path), x=None, y=None, w=190 if img.width > 190 else img.width)\n            self.ln(10)\n            img_path.unlink()\n\n    pdf = PDF()\n    pdf.add_page()\n    font_size = {\"title\": 16, \"h1\": 14, \"h2\": 12, \"body\": 12}\n\n    for section in sections:\n        title, level, content, image = section.get(\"title\", \"\"), section.get(\"level\", \"h1\"), section.get(\"content\", \"\"), section.get(\"image\")\n        pdf.set_font(\"Arial\", \"B\" if level in font_size else \"\", font_size.get(level, font_size[\"body\"]))\n        pdf.chapter_title(title)\n\n        if content: pdf.chapter_body(content)\n        if image:\n            img_data = get_image(image)\n            if img_data:\n                pdf.add_image(img_data)\n                if isinstance(img_data, BytesIO):\n                    img_data.close()\n\n    pdf.output(output_file)\n    print(f\"PDF report saved as {output_file}\")\n\n# # Example usage\n# sections = [\n#     {\n#         \"title\": \"Introduction - Early Life\",\n#         \"level\": \"h1\",\n#         \"image\": \"https://picsum.photos/536/354\",\n#         \"content\": (\"Marie Curie was born on 7 November 1867 in Warsaw, Poland. \"\n#                     \"She was the youngest of five children. Both of her parents were teachers. \"\n#                     \"Her father was a math and physics instructor, and her mother was the head of a private school. \"\n#                     \"Marie's curiosity and brilliance were evident from an early age.\"),\n#     },\n#     {\n#         \"title\": \"Academic Accomplishments\",\n#         \"level\": \"h2\",\n#         \"content\": (\"Despite many obstacles, Marie Curie earned degrees in physics and mathematics from the University of Paris. \"\n#                     \"She conducted groundbreaking research on radioactivity, becoming the first woman to win a Nobel Prize. \"\n#                     \"Her achievements paved the way for future generations of scientists, particularly women in STEM fields.\"),\n#     },\n#     {\n#         \"title\": \"Major Discoveries\",\n#         \"level\": \"h2\",\n#         \"image\": \"https://picsum.photos/536/354\",\n#         \"content\": (\"One of Marie Curie's most notable discoveries was that of radium and polonium, two radioactive elements. \"\n#                     \"Her meticulous work not only advanced scientific understanding but also had practical applications in medicine and industry.\"),\n#     },\n#     {\n#         \"title\": \"Conclusion - Legacy\",\n#         \"level\": \"h1\",\n#         \"content\": (\"Marie Curie's legacy lives on through her contributions to science, her role as a trailblazer for women in STEM, \"\n#                     \"and the ongoing impact of her discoveries on modern medicine and technology. \"\n#                     \"Her life and work remain an inspiration to many, demonstrating the power of perseverance and intellectual curiosity.\"),\n#     },\n# ]\n\n# generate_and_save_pdf_report(sections, \"my_report.pdf\", \"The Life of Marie Curie\")",
  "description": "Generate and save a pdf file based on the provided input sections.",
  "libraries": [
    "requests",
    "fpdf",
    "PIL"
  ],
  "name": "generate_and_save_pdf",
  "user_id": "guestuser@gmail.com",
  "version": "0.0.1"
}
